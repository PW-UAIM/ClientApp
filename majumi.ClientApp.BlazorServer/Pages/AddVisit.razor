@page "/addVisit"
@using majumi.CarService.ClientsAppService.Rest.Model.Model;
@inject IController controller
@inject IModel model
@inject NavigationManager NavManager

<RadzenDropDown @bind-Value=@carIDInputValue Placeholder="Wybierz swój samochód" Style="width: 100%; max-width: 400px; text-align:center" class="form-control" Data=@model.CarList TextProperty="Model" ValueProperty="CarID" />
<br>
<RadzenTextArea Placeholder="Opisz swoją usterkę tutaj ..." @bind-Value=@notesInputValue Style="width: 100%; max-width: 400px; text-align:center" class="form-control" />
<br>
<RadzenButton Click=AddVisitTask Text="Zapisz się na przegląd" type="submit" class=" form-control align-items-center nav-link custom-btn custom-border-btn btn" />
@code {
	// <RadzenDropDown @bind-Value=@serviceInputValue Data="@(Enum.GetValues(typeof(Service)).Cast<Enum>())" Style="width: 100%; max-width: 400px;" />
	int carIDInputValue;
	string notesInputValue;
	// Service serviceInputValue;

	string labelText;

	protected override async Task OnInitializedAsync()
	{
		//Check if client is logged in
		if (model.ClientID == 0 || model.LoginConfirmation == false)
		{
			NavManager.NavigateTo("/login");
		}
		await controller.LoadCarsAsync();
	}

	private async Task AddVisitTask()
	{
		VisitData visit = new VisitData()
		{
			VisitID = -100,
			CarID = carIDInputValue,
			ClientID = model.ClientID,
			MechanicID = -100,
			Notes = notesInputValue,
			ServiceCost = -100,
			ServiceDate = DateTime.Now,
			ServiceStatus = "Implement enum",
			ServiceType = "Also implement enum and then allow user to choose"
		};
		model.AddedVisit = visit;
		await controller.AddVisitAsync();

		NavManager.NavigateTo("/account");
	}
}
