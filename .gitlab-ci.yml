stages:
    - build
    - test
    - pack

build:
    stage: build
    before_script:
      - cd majumi.ClientApp.BlazorServer
    script:
      - dotnet restore
      - dotnet build -c Debug
      - dotnet build -c Release
    tags:
      - all, integration

test:
    stage: test
    needs: [build]
    before_script:
      - cd majumi.ClientApp.Tests
    script:
      - dotnet restore
      - dotnet build -c Debug
      - dotnet build -c Release
      - dotnet test
    tags:
      - all, integration


pack:
    stage: pack
    needs: [test]
    before_script:
      - cd Docker
    script:
      - BuildPushImage.bat
    tags:
      - all, integration